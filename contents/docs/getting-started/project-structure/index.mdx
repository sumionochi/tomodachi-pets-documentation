---
title: Project Structure & System Overview
description: Explore the repositories, core architecture, and feature highlights of Tomodachi Pets.
---

# ğŸ—‚ï¸ Project Structure & System Overview

Tomodachi Pets is composed of two tightly integrated repositories:  
the main web application (dApp) and a browser extension for a cross-web pet experience.

---

## Main Repository: `tomodachi-digital-pet`

<pre>
<code>
tomodachi-digital-pet/
â”œâ”€â”€ move/                         # Sui Move smart contracts
â”‚   â”œâ”€â”€ sources/
â”‚   â”‚   â””â”€â”€ game.move             # Core Move module defining Pet, Asset, ScoreBoard, etc.
â”‚   â””â”€â”€ tests/
â”‚       â””â”€â”€ move_tests.move       # Test scenarios for the Move contract
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ page.tsx              # Next.js main page (React UI for game interface)
â”‚   â”‚   â””â”€â”€ api/                  # Next.js API routes for backend logic
â”‚   â”‚       â”œâ”€â”€ upload/route.ts           # Handles image uploads to Walrus
â”‚   â”‚       â”œâ”€â”€ generate/route.ts         # Text-to-image generation via OpenAI API
â”‚   â”‚       â”œâ”€â”€ generatePetPreview/route.ts # Multi-image generation preview (AI)
â”‚   â”‚       â””â”€â”€ editPetPreview/route.ts    # Image editing endpoint for sketch-to-image via OpenAI
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ DailyQuiz.tsx         # Daily Quiz UI component (Q&A about Sui)
â”‚   â”‚   â”œâ”€â”€ AttributeInputList.tsx # Form component for adding NFT attributes
â”‚   â”‚   â””â”€â”€ ui/                   # Reusable UI components (buttons, cards, dialogs, etc.)
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ gameHooks.ts          # Custom React hooks for querying game data (pets, assets, scores)
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ sui.ts                # Sui helper library (builds transactions for mint, equip, etc.)
â”‚   â”‚   â”œâ”€â”€ utils.ts              # Utility functions (e.g., formatting)
â”‚   â”‚   â””â”€â”€ ...other helpers (localStorage, etc.)
â”‚   â””â”€â”€ (styles, config files, etc.)
â”œâ”€â”€ public/                      # Public assets (icons, etc.)
â”œâ”€â”€ package.json                 # Project dependencies (Next.js, Sui SDK, OpenAI, Walrus, etc.)
â””â”€â”€ next.config.js, tailwind.config.js, tsconfig.json, etc.
</code>
</pre>

**Tech stack highlights:**
- Built with **Next.js 13 (React + TypeScript)**
- Uses Sui SDKs (`@mysten/sui`, `wallet-kit`) for blockchain, **@mysten/walrus** for decentralized storage
- AI image generation via **OpenAI SDK**
- UI/UX with **Radix UI**, **Tailwind CSS**

---

## Extension Repository: `tomodachi-digital-pet-extension`

<pre>
<code>
tomodachi-digital-pet-extension/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ popup/
â”‚   â”‚   â”œâ”€â”€ Popup.tsx            # React popup UI for user to enter Sui address, select pet, configure assets
â”‚   â”‚   â””â”€â”€ popup.html, popup.css# HTML/CSS for the extension popup
â”‚   â”œâ”€â”€ background/
â”‚   â”‚   â””â”€â”€ background.ts        # Background script: handles messages, fetches pet data via local API
â”‚   â”œâ”€â”€ content/
â”‚   â”‚   â”œâ”€â”€ content.ts           # Content script: injects pet overlay in pages, animates assets
â”‚   â”‚   â””â”€â”€ content.css          # Styles for pet overlay (cursor-following image)
â”‚   â””â”€â”€ common/types.ts          # Shared type definitions (Pet, Asset metadata, message formats)
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ server.js                # Express server to query Sui RPC for pet/assets
â”œâ”€â”€ icons/                       # Icons for the extension (16x16, 48x48, 128x128)
â”œâ”€â”€ manifest.json                # Chrome extension manifest (permissions, content script registration)
â”œâ”€â”€ webpack.config.js            # Build configuration for the extension (bundles content, popup, background)
â””â”€â”€ package.json                 # Extensionâ€™s dependencies (uses Sui JS client, React)
</code>
</pre>

**Key components:**  
- Popup UI for Sui address, pet selection  
- Background script for RPC data fetch  
- Content script for live pet rendering  
- Local Node/Express backend for blockchain queries (avoids direct RPC from content script)

---

## ğŸ—ï¸ System Architecture

The system is composed of several interacting components:  
the user-facing web app, Sui smart contracts, Walrus storage, OpenAI AI services, and the Chrome browser extension.

<figure>
  <img src="https://github.com/user-attachments/assets/663b441d-7fa3-4c8e-bc8e-a48571e09ec6" alt="System architecture of Tomodachi Pets" />
  <figcaption>
    <b>Figure:</b> System architectureâ€”web app, on-chain logic, AI generation, decentralized storage, and browser extension, all working together.
  </figcaption>
</figure>

---

## ğŸ¤– AI Service Integration (GPT-Image-1 for Accessories)

Tomodachi Pets features **AI-generated art** for pet accessories, making every asset unique and user-driven.

- **Text-to-Image:**  
  Users describe an accessory (e.g., â€œred cowboy hat with gold trimâ€), then `/api/generate` uses OpenAIâ€™s GPT-Image-1 to create a 1024Ã—1024 transparent PNG.
- **Sketch-to-Image Editing:**  
  Users can sketch accessory outlines in-app, submit with a text prompt to `/api/editPetPreview`, and AI turns it into polished artâ€”perfect for non-artists.
- **Multi-Image Previews:**  
  `/api/generatePetPreview` fetches several AI variants so users can pick the best.
- **Manual Upload Supported:**  
  Users can always upload their own imagesâ€”handled by `/api/upload`.
- **Decentralized Storage:**  
  All finalized images are sent to Walrus and referenced in the on-chain NFT.

<figure>
  <img src="https://i.postimg.cc/9Q2LzDLS/image.png" alt="AI-generated accessory image in Tomodachi Pets" />
  <figcaption>
    <b>Figure:</b> AI-generated accessory image, created from user prompt and refined for minting as an NFT asset.
  </figcaption>
</figure>

---

## ğŸŒ Browser Extension: Pet Companion Everywhere

Tomodachi Pets' Chrome extension brings your NFT pet (and its accessories) to any website, making Web3 feel alive and fun.

- **Popup UI:** Enter Sui address, pick pet/assets
- **Background script:** Fetches on-chain pet and asset data via local API
- **Content script:** Renders pet overlay, animates assets, follows your cursor on every page
- **User control:** Toggle pet/asset visibility, hotkeys, and more

<figure>
  <img src="https://github.com/user-attachments/assets/98585c25-f3b6-4f66-9c7b-2efe03378c6b" alt="Browser extension architecture and data flow" />
  <figcaption>
    <b>Figure:</b> Extension message flow: popup configures pet, background fetches data, content script displays and animates the companion on any website.
  </figcaption>
</figure>

---

## ğŸ§‘â€ğŸ’» User Flows & Journeys

Tomodachi Pets is built for an intuitive, rewarding player experience.  
Typical user journeys:

- **ğŸ£ Creating Your Pet:**  
  New user connects Sui wallet, enters unique name, and calls `create_pet`. If available, the pet NFT is minted and appears in dashboard & wallet.
- **ğŸ¨ Designing & Minting Accessories:**  
  User draws or describes accessory, uses AI generation, uploads to Walrus, then mints as on-chain asset NFT (burns points).
- **ğŸ‘’ Equipping Accessories:**  
  User equips asset to pet (`equip_asset`). Pet updates visually both in app and extension overlay. Assets become child NFTs of pet on-chain.
- **ğŸ“… Daily Quiz & Check-In:**  
  User completes daily quiz, then claims check-in (+2 points, one per 24h via on-chain Clock logic).
- **ğŸŒ Browsing with Extension:**  
  Pet with all equipped accessories follows user's cursor everywhere online. Users can hide/show pet or switch assets with a hotkey.

<figure>
  <img src="https://i.postimg.cc/L6KT0qFX/image.png" alt="User journey creating and equipping a pet" />
  <figcaption>
    <b>Figure:</b> Creating a pet, generating accessories, equipping them, and watching your companion come alive across the web.
  </figcaption>
</figure>

---

> **All features are enforced by smart contracts, stored on Sui and Walrus, and enhanced by OpenAIâ€”offering true user ownership and creativity in a delightful, fully on-chain game.**

---
